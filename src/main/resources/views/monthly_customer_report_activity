CREATE
VIEW `monthly_customer_report_activtiy` AS
    select 
        `v_warac`.`report_customer` AS `report_customer`,
        `v_warac`.`report_year` AS `report_year`,
        `v_warac`.`report_month` AS `report_month`,
        `v_warac`.`report_customer_id` AS `report_customer_id`,
        `v_warac`.`report_agent` AS `report_agent`,
        `v_warac`.`report_school_year` AS `report_school_year`,
        `v_warac`.`report_region` AS `report_region`,
        `v_warac`.`report_market_potential_segment` AS `report_market_potential_segment`,
        `v_warac`.`report_market_potential` AS `report_market_potential`,
        `ct`.`war_customer_tag_index` AS `report_tag_index`,
        `fud`.`full_name` AS `report_materials_advisor`,
        sum(`v_warac`.`report_actual`) AS `report_frequency`,
        sum(`v_warac`.`report_planned`) AS `report_planned`,
        sum(`v_warac`.`report_exam_copies_distribution`) AS `report_exam_copies_distribution`,
        sum(`v_warac`.`report_confirmation_of_events`) AS `report_confirmation_of_events`,
        sum(`v_warac`.`report_delivery_of_additional_order_trm_compliance`) AS `report_delivery_of_additional_order_trm_compliance`,
        sum(`v_warac`.`report_delivery_of_incentive_donation`) AS `report_delivery_of_incentive_donation`,
        sum(`v_warac`.`report_giveaways_distribution`) AS `report_giveaways_distribution`,
        sum(`v_warac`.`report_implemented_ex_sem`) AS `report_implemented_ex_sem`,
        sum(`v_warac`.`report_invitation_to_events`) AS `report_invitation_to_events`,
        sum(`v_warac`.`report_purchase_order`) AS `report_purchase_order`,
        sum(`v_warac`.`report_updated_customer_info_sheet`) AS `report_updated_customer_info_sheet`,
        sum(`v_warac`.`report_follow_up_payment`) AS `report_follow_up_payment`,
        sum(`v_warac`.`report_booklist`) AS `report_book_list`,
        sum(`v_warac`.`report_customer_specific_activity`) AS `report_customer_specific_activity`,
        sum(`v_warac`.`report_bootcamp`) AS `report_bootcamp`,
        sum(`v_warac`.`report_aecon`) AS `report_aecon`,
        sum(`v_warac`.`report_ceap`) AS `report_ceap`,
        sum(`v_warac`.`report_collection_and_pr`) AS `report_collection_and_pr`
    from
        ((((`weekly_agent_report_activity_customer_day` `v_warac`
        left join `war_customer_tag` `ct` ON (((`ct`.`war_customer_tag_customer` = `v_warac`.`report_customer_id`)
            and (`ct`.`war_customer_tag_region_code` = `v_warac`.`report_region`))))
        join `war_agent` `wa` ON ((`wa`.`war_agent_id` = `v_warac`.`report_agent`)))
        join `flow_user` `fu` ON ((`fu`.`flow_user_id` = `wa`.`user`)))
        join `flow_user_detail` `fud` ON ((`fud`.`flow_user_detail_id` = `fu`.`flow_user_detail_id`)))
    group by `v_warac`.`report_school_year` , `v_warac`.`report_month` , `v_warac`.`report_customer` , `v_warac`.`report_agent`
    order by `v_warac`.`report_customer`